#!/usr/bin/ruby
# - encoding: utf-8 -
require 'tmpdir'

folder = Dir.mktmpdir
name = ARGV[0]
abort "No filename given." if name.nil?

width = ARGV[1] || 400
fps = ARGV[2] || 10

basename = File.basename(name, ".*")
system("ffmpeg -i #{name} -vf scale=#{width}:-1:flags=lanczos,fps=#{fps} #{folder}/frame-%03d.png")
system("convert -loop 0 #{folder}/frame-*png #{basename}.gif")
